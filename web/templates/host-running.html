{{define "content"}}
<div class="nes-container with-title">
    <p class="title">Hosting Game</p>

    <div class="nes-field">
        <label for="invite-code">Invite Code</label>
        <div class="copy-row">
            <input id="invite-code" class="nes-input" readonly value="{{.InviteCode}}">
            <button type="button" class="nes-btn is-primary" onclick="copyToClipboard('invite-code', this)">Copy</button>
        </div>
    </div>

    <div class="nes-field">
        <label for="game-address">Game Address</label>
        <div class="copy-row">
            <input id="game-address" class="nes-input" readonly value="{{.GameAddress}}">
            <button type="button" class="nes-btn is-primary" onclick="copyToClipboard('game-address', this)">Copy</button>
        </div>
    </div>

    <div class="nes-field">
        <label>Logs</label>
        <div class="logs-terminal" id="logs"></div>
    </div>

    <form method="POST" action="/host/stop">
        <button type="submit" class="nes-btn is-error">Stop Hosting</button>
    </form>
</div>

<script>
    function copyToClipboard(inputId, btn) {
        const input = document.getElementById(inputId);
        navigator.clipboard.writeText(input.value).then(() => {
            clearTimeout(btn._copyTimeout);
            btn.textContent = 'Copied!';
            btn.classList.remove('is-primary');
            btn.classList.add('is-success');
            btn._copyTimeout = setTimeout(() => {
                btn.textContent = 'Copy';
                btn.classList.remove('is-success');
                btn.classList.add('is-primary');
            }, 1500);
        });
    }

    const logs = document.getElementById('logs');
    const eventSource = new EventSource('/logs');
    eventSource.onmessage = function(event) {
        const line = document.createElement('div');
        line.textContent = event.data;
        logs.appendChild(line);
        logs.scrollTop = logs.scrollHeight;
    };
</script>
{{end}}
